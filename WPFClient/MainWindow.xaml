<Window x:Class="MyGame.MainWindow"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:local="clr-namespace:MyGame"
	Title="Window1" Height="424" Width="800"
    DataContext="{x:Static local:GameData.Data}">

	<DockPanel>
		<ToolBarTray DockPanel.Dock="Top">
			<ToolBar>
				<ToggleButton IsChecked="{Binding Path=DisableLOS}">Disable Client LOS</ToggleButton>
				<ToggleButton IsChecked="{Binding Path=ShowChangedTiles}">Show New Tiles</ToggleButton>
				<Button Click="OnClearLogClicked">Clear Log</Button>
			</ToolBar>

			<ToolBar>
				<StackPanel Orientation="Horizontal">
					<TextBlock VerticalAlignment="Center">FollowOb</TextBlock>

					<ComboBox MinWidth="100" ItemsSource="{Binding Objects}"
                          SelectedItem="{Binding Path=FollowObject, ElementName=map}"
                          IsReadOnly="True">
						<ComboBox.ItemTemplate>
							<DataTemplate>
								<StackPanel Orientation="Horizontal">
									<Image Source="{Binding Drawing}" Stretch="Uniform" Height="20" />
									<TextBlock Text="{Binding Name}" />
								</StackPanel>
							</DataTemplate>
						</ComboBox.ItemTemplate>
					</ComboBox>
				</StackPanel>
			</ToolBar>

		</ToolBarTray>

		<StatusBar DockPanel.Dock="Bottom" >
			<TextBlock>
        		Turn <TextBlock Text="{Binding Path=TurnNumber}" />
			</TextBlock>
		</StatusBar>

		<Grid>
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="3*"/>
				<ColumnDefinition Width="1*"/>
				<ColumnDefinition Width="1*"/>
			</Grid.ColumnDefinitions>

			<Grid.RowDefinitions>
				<RowDefinition />
				<RowDefinition />
			</Grid.RowDefinitions>

			<local:MapControl x:Name="map" Grid.Column="0" Grid.Row="0" Grid.RowSpan="2">
				<local:MapControl.ContextMenu>
					<ContextMenu>
						<MenuItem Header="Change tile">
							<MenuItem Header="Floor" Click="MenuItem_Click_Floor" />
							<MenuItem Header="Wall" Click="MenuItem_Click_Wall"/>
						</MenuItem>
						<MenuItem Header="File"/>
						<MenuItem Header="Save"/>
						<MenuItem Header="SaveAs"/>
					</ContextMenu>
				</local:MapControl.ContextMenu>
			</local:MapControl>

			<GroupBox Grid.Column="1" Grid.Row="0" Header="Inventory" Focusable="False">
				<DockPanel>
					<Button DockPanel.Dock="Bottom" Click="Drop_Button_Click">Drop</Button>
					<ListBox Name="inventoryListBox"
							 ItemsSource="{Binding Path=Player.Inventory}">
						<ListBox.ItemTemplate>
							<DataTemplate>
								<StackPanel Orientation="Horizontal">
									<StackPanel.ToolTip>
										<StackPanel Orientation="Vertical">
											<Image Source="{Binding Path=Drawing}" Stretch="Uniform" />
											<TextBlock Text="{Binding Path=Name}" HorizontalAlignment="Center" />
										</StackPanel>
									</StackPanel.ToolTip>
									<Image Source="{Binding Path=Drawing}" Stretch="Uniform" Height="20" />
									<TextBlock Text="{Binding Path=Name}" />
								</StackPanel>
							</DataTemplate>
						</ListBox.ItemTemplate>
					</ListBox>
				</DockPanel>
			</GroupBox>

			<GroupBox Grid.Column="1" Grid.Row="1" Header="Pending Actions">
				<ListBox ItemsSource="{Binding Path=ActionCollection}" VerticalContentAlignment="Stretch" HorizontalContentAlignment="Stretch" />
			</GroupBox>

			<GroupBox Grid.Column="2" Grid.Row="0" Header="Current Tile Info"
					  DataContext="{Binding Path=CurrentTileInfo, ElementName=map}">
				<DockPanel>
					<StackPanel DockPanel.Dock="Top">
						<TextBlock>Location: <TextBlock Text="{Binding Location}" /></TextBlock>
						<TextBlock>Terrain: <TextBlock Text="{Binding TerrainType}" /></TextBlock>
					</StackPanel>
					<Button DockPanel.Dock="Bottom" Click="Get_Button_Click">Get</Button>
					<ListBox Name="currentTileItems" ItemsSource="{Binding Objects}">
						<ListBox.ItemTemplate>
							<DataTemplate>
								<StackPanel Orientation="Horizontal">
									<Image Source="{Binding Path=Drawing}" Stretch="Uniform" Height="20" />
									<TextBlock Text="{Binding Path=Name}" />
								</StackPanel>
							</DataTemplate>
						</ListBox.ItemTemplate>
					</ListBox>
				</DockPanel>
			</GroupBox>

			<GroupBox Grid.Column="2" Grid.Row="1" Header="Selected Tile Info"
					  DataContext="{Binding Path=SelectedTileInfo, ElementName=map}">
				<DockPanel>
					<StackPanel DockPanel.Dock="Top">
						<TextBlock>Location: <TextBlock Text="{Binding Location}" /></TextBlock>
						<TextBlock>Terrain: <TextBlock Text="{Binding TerrainType}" /></TextBlock>
					</StackPanel>
					<ListBox ItemsSource="{Binding Objects}">
						<ListBox.ItemTemplate>
							<DataTemplate>
								<StackPanel Orientation="Horizontal">
									<Image Source="{Binding Path=Drawing}" Stretch="Uniform" Height="20" />
									<TextBlock Text="{Binding Path=Name}" />
								</StackPanel>
							</DataTemplate>
						</ListBox.ItemTemplate>
					</ListBox>
				</DockPanel>
			</GroupBox>
		</Grid>

	</DockPanel>

</Window>
